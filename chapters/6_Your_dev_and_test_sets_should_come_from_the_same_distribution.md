## 6 Your dev and test sets should come from the same distribution

<div style="text-align:center;">
  <img src="../img/6_1.PNG" />
</div>

고양이사진 분류 앱에 대한 이미지 데이터를, 가장 큰 시장성이 있는 4가지 지역에 기반하여 보관할 수 있다. 예를 들어서, (i) 미국, (ii) 중국, (iii) 인도, (iv) 그외지역 처럼 말이다. 개발/테스트 데이터셋을 구축하기 위해서, 미국과 인도를 개발 데이터셋에 넣고 중국과 그외지역을 테스트 데이터셋에 넣는다고 가정해 보자. 다시 말하자면, 무작위로 4가지 지역 중 2곳을 개발 데이터셋으로, 나머지 2곳을 테스트 데이터셋으로 위치할 수 있다는 것이다.

일단 개발/테스트 데이터셋의 정의가 되고 나면, 개발 데이터셋에 대하여 알고리즘 성능을 향상 시키는데 집중하게 될 것이다. 따라서, ***개발 데이터셋은 가장 성능 향상을 원하는 부분*** (예: 2개의 지역에만이 아닌, 4개 지역 모두에 작동을 잘하는 결과)을 ***반영*** 해야만 한다.

두 번째 고려 사항은 ***개발 데이터셋과 테스트 데이터셋이 서로 다른 데이터 분포를 가질 수 있다는 것*** 이다. 한쪽의 데이터셋에서 잘 작동하는 알고리즘이, 다른 한쪽의 데이터셋에 대하여 만족할 만한 성능 결과를 보여주지 못할 수 있다. 나는 이런 경우를 많이 목격해 왔고, 이는 좌절과 쓸데없는 노력의 낭비를 가져오곤 했다. 이런 일이 생기는 것을 피해야만 한다.

한 가지 예로, 당신의 팀이 개발한 시스템이 개발 데이터셋에 잘 동작하지만 테스트 데이터셋에는 잘 동작하지 않는다고 가정해 보자. 개발 데이터셋과 테스트 데이터셋이 ***동일한 데이터 분포*** 를 가진다면, 과적합과 같은 문제가 발생 했을 때 뭐가 잘못 됐는지에 대하여 ***매우 명확한 진단*** 을 내릴 수 있다. 이 경우의 과적합 문제가 발생 했을때, 분명한 해결책은 더 많은 개발 데이터셋을 확보하는 것이다.

하지만 개발/테스트 데이터셋이 ***서로다른 데이터 분포를 가진다면*** , 문제가 발생 했을때 무엇을 해야 하는지에 대한 ***해결책을 세우기가 불명확*** 하고 쉽지 않다. 다음과 같은 것들을 생각해 볼 수는 있겠다.

- __1. 개발 데이터셋에 대하여 과적합이 일어 났다.__

- __2. 테스트 데이터셋이 개발 데이터셋보다 학습되기 어렵다.__
  - 이런 경우, 알고리즘이 기대한 만큼의 성능을 보여주기는 하지만, 그 이상의 성능 향상이 어렵다.
  
- __3. 테스트 데이터셋이 딱히 더 학습되기 어려운 것은 아니지만, 개발 데이터셋과는 다르다.__
  - 이런 경우, 개발 데이터셋에 잘 동작하던 알고리즘이 테스트 데이터셋에서는 잘 동작하지 않는 것을 알 수 있다. 그렇다면, 개발 데이터셋에 대한 성능을 향상 시키기 위한 많은 노력이 의미없는 시간 낭비가 되어 버린다.

머신러닝 어플리케이션을 개발하는 것은 꽤나 어려운 일이다. 동일한 데이터분포를 가지지 않는 개발/테스트 데이터셋은 "개발 데이터셋에 대하여 성능을 향상시키는 일이 테스트 데이터셋에 대한 성능을 향상 시킬 수 있는가?" 에 대한 추가적인 불확실성을 가져다 준다. 이러한 데이터셋은 뭐가 알고리즘을 잘 동작하게 만드는지, 그렇지 않게 만드는지 알아내기 어렵게 만든다. 그래서 무엇에 우선순위를 두고 일을 해야하는지를 정하기 어렵게 된다.

만약 제3의 단체(회사)에 대한 벤치마킹을 수행 하는 경우, 그 곳에는 정해진 개발/테스트 데이터셋이 존재할수 있고, 마찬가지로 서로다른 데이터 분포를 가질 수 있다. 이런 경우에는 기술적인 측면 보다는, 운이 성능을 뽑아내는데 더 큰 영향을 끼칠 수 있다. 한가지 데이터 분포에 대하여 학습된 알고리즘이 다른 데이터 분포에도 잘 동작하도록 일반화 하는 것은 아주 중요한 연구 주제 중 하나이다. 하지만, ***당신의 목표*** 가 ***연구적인 중요한 발견이 아니라*** 특정 머신 러닝 어플리케이션에 대해서 ***잘 동작하는 결과를 얻는 것*** 이라면, ***개발/테스트 데이터셋이 동일한 이미지 분포를 가지도록 구성하는 것을 추천*** 한다. 훨씬 효율적으로 개발이 가능 할 것이다.
